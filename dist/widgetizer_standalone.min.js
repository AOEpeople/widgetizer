!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(n):e[t]=n}(this,"qwest",function(){var win=window,doc=document,before,defaultXdrResponseType="json",limit=null,requests=0,request_stack=[],getXHR=function(){return win.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},xhr2=""===getXHR().responseType,qwest=function(method,url,data,options,before){method=method.toUpperCase(),data=data||null,options=options||{};var nativeResponseParsing=!1,crossOrigin,xhr,xdr=!1,timeoutInterval,aborted=!1,attempts=0,headers={},mimeTypes={text:"*/*",xml:"text/xml",json:"application/json",post:"application/x-www-form-urlencoded"},accept={text:"*/*",xml:"application/xml; q=1.0, text/xml; q=0.8, */*; q=0.1",json:"application/json; q=1.0, text/*; q=0.8, */*; q=0.1"},contentType="Content-Type",vars="",i,j,serialized,then_stack=[],catch_stack=[],complete_stack=[],response,success,error,func,promises={then:function(e){return options.async?then_stack.push(e):success&&e.call(xhr,response),promises},"catch":function(e){return options.async?catch_stack.push(e):error&&e.call(xhr,response),promises},complete:function(e){return options.async?complete_stack.push(e):e.call(xhr),promises}},promises_limit={then:function(e){return request_stack[request_stack.length-1].then.push(e),promises_limit},"catch":function(e){return request_stack[request_stack.length-1]["catch"].push(e),promises_limit},complete:function(e){return request_stack[request_stack.length-1].complete.push(e),promises_limit}},handleResponse=function(){if(!aborted){var i,req,p,responseType;if(--requests,clearInterval(timeoutInterval),request_stack.length){for(req=request_stack.shift(),p=qwest(req.method,req.url,req.data,req.options,req.before),i=0;func=req.then[i];++i)p.then(func);for(i=0;func=req["catch"][i];++i)p["catch"](func);for(i=0;func=req.complete[i];++i)p.complete(func)}try{if("status"in xhr&&!/^2|1223/.test(xhr.status))throw xhr.status+" ("+xhr.statusText+")";var responseText="responseText",responseXML="responseXML",parseError="parseError";if(nativeResponseParsing&&"response"in xhr&&null!==xhr.response)response=xhr.response;else if("document"==options.responseType){var frame=doc.createElement("iframe");frame.style.display="none",doc.body.appendChild(frame),frame.contentDocument.open(),frame.contentDocument.write(xhr.response),frame.contentDocument.close(),response=frame.contentDocument,doc.body.removeChild(frame)}else{if(responseType=options.responseType,"auto"==responseType)if(xdr)responseType=defaultXdrResponseType;else{var ct=xhr.getResponseHeader(contentType);responseType=ct.indexOf(mimeTypes.json)>-1?"json":ct.indexOf(mimeTypes.xml)>-1?"xml":"text"}switch(responseType){case"json":try{response="JSON"in win?JSON.parse(xhr[responseText]):eval("("+xhr[responseText]+")")}catch(e){throw"Error while parsing JSON body : "+e}break;case"xml":try{win.DOMParser?response=(new DOMParser).parseFromString(xhr[responseText],"text/xml"):(response=new ActiveXObject("Microsoft.XMLDOM"),response.async="false",response.loadXML(xhr[responseText]))}catch(e){response=void 0}if(!response||!response.documentElement||response.getElementsByTagName("parsererror").length)throw"Invalid XML";break;default:response=xhr[responseText]}}if(success=!0,p=response,options.async)for(i=0;func=then_stack[i];++i)p=func.call(xhr,p)}catch(e){if(error=!0,options.async)for(i=0;func=catch_stack[i];++i)func.call(xhr,e,url)}if(options.async)for(i=0;func=complete_stack[i];++i)func.call(xhr)}},buildData=function(e,t){var n,r=[],i=encodeURIComponent;if("object"==typeof e&&null!=e){for(n in e)if(e.hasOwnProperty(n)){var o=buildData(e[n],t?t+"["+n+"]":n);""!==o&&(r=r.concat(o))}}else null!=e&&null!=t&&r.push(i(t)+"="+i(e));return r.join("&")};switch(++requests,"retries"in options&&(win.console&&console.warn&&console.warn('[Qwest] The retries option is deprecated. It indicates total number of requests to attempt. Please use the "attempts" option.'),options.attempts=options.retries),options.async="async"in options?!!options.async:!0,options.cache="cache"in options?!!options.cache:"GET"!=method,options.dataType="dataType"in options?options.dataType.toLowerCase():"post",options.responseType="responseType"in options?options.responseType.toLowerCase():"auto",options.user=options.user||"",options.password=options.password||"",options.withCredentials=!!options.withCredentials,options.timeout="timeout"in options?parseInt(options.timeout,10):3e3,options.attempts="attempts"in options?parseInt(options.attempts,10):3,i=url.match(/\/\/(.+?)\//),crossOrigin=i&&i[1]?i[1]!=location.host:!1,"ArrayBuffer"in win&&data instanceof ArrayBuffer?options.dataType="arraybuffer":"Blob"in win&&data instanceof Blob?options.dataType="blob":"Document"in win&&data instanceof Document?options.dataType="document":"FormData"in win&&data instanceof FormData&&(options.dataType="formdata"),options.dataType){case"json":data=JSON.stringify(data);break;case"post":data=buildData(data)}if(options.headers){var format=function(e,t,n){return t+n.toUpperCase()};for(i in options.headers)headers[i.replace(/(^|-)([^-])/g,format)]=options.headers[i]}if(headers[contentType]||"GET"==method||options.dataType in mimeTypes&&mimeTypes[options.dataType]&&(headers[contentType]=mimeTypes[options.dataType]),headers.Accept||(headers.Accept=options.responseType in accept?accept[options.responseType]:"*/*"),crossOrigin||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest"),"GET"==method&&(vars+=data),options.cache||(vars&&(vars+="&"),vars+="__t="+ +new Date),vars&&(url+=(/\?/.test(url)?"&":"?")+vars),limit&&requests==limit)return request_stack.push({method:method,url:url,data:data,options:options,before:before,then:[],"catch":[],complete:[]}),promises_limit;var send=function(){if(xhr=getXHR(),crossOrigin&&("withCredentials"in xhr||!win.XDomainRequest||(xhr=new XDomainRequest,xdr=!0,"GET"!=method&&"POST"!=method&&(method="POST"))),xdr?xhr.open(method,url):(xhr.open(method,url,options.async,options.user,options.password),xhr2&&options.async&&(xhr.withCredentials=options.withCredentials)),!xdr)for(var e in headers)xhr.setRequestHeader(e,headers[e]);if(xhr2&&"document"!=options.responseType)try{xhr.responseType=options.responseType,nativeResponseParsing=xhr.responseType==options.responseType}catch(t){}xhr2||xdr?xhr.onload=handleResponse:xhr.onreadystatechange=function(){4==xhr.readyState&&handleResponse()},"auto"!==options.responseType&&"overrideMimeType"in xhr&&xhr.overrideMimeType(mimeTypes[options.responseType]),before&&before.call(xhr),xdr?setTimeout(function(){xhr.send("GET"!=method?data:null)},0):xhr.send("GET"!=method?data:null)},timeout=function(){timeoutInterval=setTimeout(function(){if(aborted=!0,xhr.abort(),options.attempts&&++attempts==options.attempts){if(aborted=!1,error=!0,response="Timeout ("+url+")",options.async)for(i=0;func=catch_stack[i];++i)func.call(xhr,response)}else aborted=!1,timeout(),send()},options.timeout)};return timeout(),send(),promises},create=function(e){return function(t,n,r){var i=before;return before=null,qwest(e,t,n,r,i)}},obj={before:function(e){return before=e,obj},get:create("GET"),post:create("POST"),put:create("PUT"),"delete":create("DELETE"),xhr2:xhr2,limit:function(e){limit=e},setDefaultXdrResponseType:function(e){defaultXdrResponseType=e.toLowerCase()}};return obj}());var Mark={includes:{},globals:{},delimiter:">",compact:!1,_copy:function(e,t){t=t||[];for(var n in e)t[n]=e[n];return t},_size:function(e){return e instanceof Array?e.length:e||0},_iter:function(e,t){this.idx=e,this.size=t,this.length=t,this.sign="#",this.toString=function(){return this.idx+this.sign.length-1}},_pipe:function(e,t){var n,r,i,o;if(n=t.shift()){r=n.split(this.delimiter),i=r.shift().trim();try{o=Mark.pipes[i].apply(null,[e].concat(r)),e=this._pipe(o,t)}catch(s){}}return e},_eval:function(e,t,n){var r,i,o=this._pipe(e,t),s=o,a=-1;if(o instanceof Array)for(o="",r=s.length;++a<r;)i={iter:new this._iter(a,r)},o+=n?Mark.up(n,s[a],i):s[a];else o instanceof Object&&(o=Mark.up(n,s));return o},_test:function(e,t,n,r){var i=Mark.up(t,n,r).split(/\{\{\s*else\s*\}\}/);return(e===!1?i[1]:i[0])||""},_bridge:function(e,t){t="."==t?"\\.":t.replace(/\$/g,"\\$");var n,r,i="{{\\s*"+t+"([^/}]+\\w*)?}}|{{/"+t+"\\s*}}",o=new RegExp(i,"g"),s=e.match(o)||[],a=0,c=0,p=-1,u=0;for(r=0;r<s.length&&(n=r,p=e.indexOf(s[n],p+1),s[n].indexOf("{{/")>-1?c++:a++,a!==c);r++);return a=e.indexOf(s[0]),c=a+s[0].length,u=p+s[n].length,[e.substring(a,u),e.substring(c,p)]}};Mark.up=function(e,t,n){t=t||{},n=n||{};var r,i,o,s,a,c,p,u,d,l,f=/\{\{(.+?)\}\}/g,h=e.match(f)||[],g=[],m=0,y=0;for(n.pipes&&this._copy(n.pipes,this.pipes),n.includes&&this._copy(n.includes,this.includes),n.globals&&this._copy(n.globals,this.globals),n.delimiter&&(this.delimiter=n.delimiter),void 0!==n.compact&&(this.compact=n.compact);r=h[m++];)if(p=void 0,c="",s=r.indexOf("/}}")>-1,i=r.substr(2,r.length-(s?5:4)),i=i.replace(/`(.+?)`/g,function(e,n){return Mark.up("{{"+n+"}}",t)}),a=0===i.trim().indexOf("if "),g=i.split("|"),g.shift(),i=i.replace(/^\s*if/,"").split("|").shift().trim(),o=a?"if":i.split("|")[0],l=t[i],a&&!g.length&&(g=["notempty"]),!s&&e.indexOf("{{/"+o)>-1&&(p=this._bridge(e,o),r=p[0],c=p[1],m+=r.match(f).length-1),!/^\{\{\s*else\s*\}\}$/.test(r)){if(void 0!==(u=this.globals[i]))p=this._eval(u,g,c);else if(d=this.includes[i])d instanceof Function&&(d=d()),p=this._pipe(Mark.up(d,t,n),g);else if(i.indexOf("#")>-1)n.iter.sign=i,p=this._pipe(n.iter,g);else if("."===i)p=this._pipe(t,g);else if(i.indexOf(".")>-1){for(i=i.split("."),l=Mark.globals[i[0]],l?y=1:(y=0,l=t);l&&y<i.length;)l=l[i[y++]];p=this._eval(l,g,c)}else a?p=this._pipe(l,g):l instanceof Array?p=this._eval(l,g,c):c?p=l?Mark.up(c,l):void 0:t.hasOwnProperty(i)&&(p=this._pipe(l,g));p instanceof Array&&(p=this._eval(p,g,c)),a&&(p=this._test(p,c,t,n)),e=e.replace(r,void 0===p?"???":p)}return this.compact?e.replace(/>\s+</g,"><"):e},Mark.pipes={empty:function(e){return e&&0!==(e+"").trim().length?!1:e},notempty:function(e){return e&&(e+"").trim().length?e:!1},blank:function(e,t){return e||0===e?e:t},more:function(e,t){return Mark._size(e)>t?e:!1},less:function(e,t){return Mark._size(e)<t?e:!1},ormore:function(e,t){return Mark._size(e)>=t?e:!1},orless:function(e,t){return Mark._size(e)<=t?e:!1},between:function(e,t,n){return e=Mark._size(e),e>=t&&n>=e?e:!1},equals:function(e,t){return e==t?e:!1},notequals:function(e,t){return e!=t?e:!1},like:function(e,t){return new RegExp(t,"i").test(e)?e:!1},notlike:function(e,t){return Mark.pipes.like(e,t)?!1:e},upcase:function(e){return String(e).toUpperCase()},downcase:function(e){return String(e).toLowerCase()},capcase:function(e){return e.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})},chop:function(e,t){return e.length>t?e.substr(0,t)+"...":e},tease:function(e,t){var n=e.split(/\s+/);return n.slice(0,t).join(" ")+(n.length>t?"...":"")},trim:function(e){return e.trim()},pack:function(e){return e.trim().replace(/\s{2,}/g," ")},round:function(e){return Math.round(+e)},clean:function(e){return String(e).replace(/<\/?[^>]+>/gi,"")},size:function(e){return e.length},length:function(e){return e.length},reverse:function(e){return[].concat(e).reverse()},join:function(e,t){return e.join(t)},limit:function(e,t,n){return e.slice(+n||0,+t+(+n||0))},split:function(e,t){return e.split(t||",")},choose:function(e,t,n){return e?t:n||""},toggle:function(e,t,n,r){return n.split(",")[t.match(/\w+/g).indexOf(e+"")]||r},sort:function(e,t){var n=function(e,n){return e[t]>n[t]?1:-1};return[].concat(e).sort(t?n:void 0)},fix:function(e,t){return(+e).toFixed(t)},mod:function(e,t){return+e%+t},divisible:function(e,t){return e&&+e%t===0?e:!1},even:function(e){return e&&0===(1&+e)?e:!1},odd:function(e){return e&&1===(1&+e)?e:!1},number:function(e){return parseFloat(e.replace(/[^\-\d\.]/g,""))},url:function(e){return encodeURI(e)},bool:function(e){return!!e},falsy:function(e){return!e},first:function(e){return 0===e.idx},last:function(e){return e.idx===e.size-1},call:function(e,t){return e[t].apply(e,[].slice.call(arguments,2))},set:function(e,t){return Mark.globals[t]=e,""},log:function(e){return console.log(e),e}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),"undefined"!=typeof module&&module.exports?module.exports=Mark:"function"==typeof define&&define.amd&&define(function(){return Mark});var AOEWidgetizer=AOEWidgetizer||{};"function"==typeof window.define&&window.define.amd&&define("aoewidgetizer",[],function(){return AOEWidgetizer}),AOEWidgetizer.Widgetizer=function(){var e=new AOEWidgetizer.WidgetSelect(AOEWidgetizer.Widget),t=new AOEWidgetizer.RequestUrlBuilder,n=new AOEWidgetizer.XHRRequest,r=new AOEWidgetizer.JSON2Markup,i=new AOEWidgetizer.WidgetRenderer,o=new AOEWidgetizer.ConfigCheck,s=new AOEWidgetizer.TemplateProvider,a=[];return init=function(){if(o.checkConfig()){a=e.getWidgets(),a=t.addUrisToWidgets(a);for(var c=0;c<a.length;c++){var p=a[c];n.getWidgetJSON(p.endpoint).then(function(e){p.set("json",e),p.set("template",s.getTemplate()),p=r.addMarkupToWidget(p),i.renderWidget(p)})["catch"](function(e){console.log("Error loading widget. Original error: ",e)})}}},{init:function(){init()},getWidgets:function(){return a}}},AOEWidgetizer.config=function(){return{widgetSelector:"[data-sp_widget]",parametersAttribute:"data-parameters",configurationAttribute:"data-configuration",widgetEndpoint:"https://cockpit.latest.fraport-search.aoe.host/frontend/widgets/"}}(),AOEWidgetizer.ConfigCheck=function(){var e=function(){var e="You have to configure the #property# in your config. Bailing out.";return AOEWidgetizer.config?"undefined"==typeof AOEWidgetizer.config.widgetSelector?(console.log(e.replace("#property#","widgetSelector")),!1):"undefined"==typeof AOEWidgetizer.config.widgetEndpoint?(console.log(e.replace("#property#","widgetEndpoint")),!1):"undefined"==typeof AOEWidgetizer.config.parametersAttribute?(console.log(e.replace("#property#","parametersAttribute")),!1):"undefined"==typeof AOEWidgetizer.config.configurationAttribute?(console.log(e.replace("#property#","configurationAttribute")),!1):!0:(console.log("No config present at all. Please create AOEWidgetizer.config object. Bailing out."),!1)};return{checkConfig:function(){return e()}}},AOEWidgetizer.JSON2Markup=function(){return{addMarkupToWidget:function(e){return e.set("markup",Mark.up(e.template,e.json)),e}}},AOEWidgetizer.RequestUrlBuilder=function(){return buildWidgetUris=function(e){function t(e){var t=parseInt(e.getAttribute(AOEWidgetizer.config.widgetSelector.replace("[","").replace("]","")));return isNaN(t)?"":t}function n(e){var t=e.getAttribute(AOEWidgetizer.config.parametersAttribute),n=JSON.parse(t),r="",i=!0;for(var o in n)r+=i?"?"+o+"="+n[o]:"&"+o+"="+n[o],i=!1;return r}for(var r=0;r<e.length;r++){var i=e[r],o=AOEWidgetizer.config.widgetEndpoint;o+=t(i.node),o+=n(i.node),i.endpoint=o}return e},noArrayGiven=function(e){return e&&e.constructor===Array?!1:(console.log("Method getUrisForWidget needs array of AOEWidgetizer.Widget elements. No array given. Returning empty array."),!0)},{addUrisToWidgets:function(e){return noArrayGiven(e)?[]:buildWidgetUris(e)}}},AOEWidgetizer.TemplateProvider=function(){return{getTemplate:function(){return'{{collection.items}}{{if data.title}} <h1>{{data.title}}</h1> {{/if}}{{if data.previewimage}} <img src="{{data.previewimage}}" /> {{/if}}{{if data.description}} <span>{{data.description}}</span> {{/if}}{{/collection.items}}'}}},AOEWidgetizer.Widget=function(){return{constructorName:"AOEWidgetizer.Widget",set:function(e,t){this[e]=t},get:function(e){return this[e]}}},AOEWidgetizer.WidgetRenderer=function(){return{renderWidget:function(e){var t=e.get("markup"),n=e.get("node");n.innerHTML=t}}},AOEWidgetizer.WidgetSelect=function(e){var t,n=[],r=function(){return"function"!=typeof document.querySelectorAll?(console.log("This browser doesn't support querySelectorAll. Returning empty array."),n):(t=document.querySelectorAll(AOEWidgetizer.config.widgetSelector),i(),n)},i=function(){for(var r=0;r<t.length;r++){var i=new e;i.set("node",t[r]),n.push(i)}};return{getWidgets:function(){return r()}}},AOEWidgetizer.XHRRequest=function(){return{getWidgetJSON:function(e){return qwest.get(e,null,{responseType:"json"})}}};